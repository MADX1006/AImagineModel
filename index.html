    <!doctype html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>WEBSURE</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
            body { font-family: 'Inter', sans-serif; }
            .content-section { display: none; }
            .content-section.active { display: block; }
            
            /* Custom styles for the risk chart */
            #risk-chart {
                display: block;
            }
        </style>
    </head>
    <body class="bg-gray-900 min-h-screen flex flex-col text-gray-100">
        <!-- Navigation Bar -->
        <nav class="bg-gray-800 shadow-lg py-4 px-6 flex justify-between items-center sticky top-0 z-50">
            <div class="text-2xl font-bold text-blue-400">WEBSURE</div>
            <div class="space-x-4">
                <a href="#" onclick="showSection('home')" class="text-gray-300 hover:text-blue-400 transition-colors duration-200 font-semibold">Home</a>
                <a href="#" onclick="showSection('about')" class="text-gray-300 hover:text-blue-400 transition-colors duration-200 font-semibold">About</a>
                <a href="#" onclick="showSection('credits')" class="text-gray-300 hover:text-blue-400 transition-colors duration-200 font-semibold">Credits</a>
                <a href="#" onclick="showSection('dashboard')" class="px-4 py-2 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200">Dashboard</a>
            </div>
        </nav>

        <main class="flex-1 p-8">
            <!-- Home Section -->
            <section id="home-section" class="content-section active bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-4xl mx-auto space-y-6 text-center">
                <h1 class="text-4xl font-bold text-gray-100">Welcome to <span class="text-blue-400">WEBSURE</span></h1>
                <p class="text-gray-300 text-lg max-w-2xl mx-auto">
                    WEBSURE is your all-in-one solution for web application security analysis, performance monitoring, and collaborative testing.
                    Our platform provides a comprehensive suite of tools to help you identify vulnerabilities, run detailed test cases,
                    and communicate with your team in real-time. With WEBSURE, you can ensure your web applications are robust, secure, and ready for production.
                </p>
            </section>

            <!-- About Section -->
            <section id="about-section" class="content-section bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-100 text-center mb-6">About WEBSURE</h2>
                <p class="text-gray-300 text-lg mb-4">
                    WEBSURE was created to simplify the complex and often fragmented process of web application security testing. We noticed that security teams and developers often
                    juggle multiple tools, making it difficult to maintain a clear overview of a project's security posture. Our platform integrates four key functionalities into a single,
                    intuitive dashboard:
                </p>
                <ul class="list-disc list-inside text-gray-300 text-lg space-y-2">
                    <li>**Test Case Management:** Track the success and failure rates of your security test cases.</li>
                    <li>**AI-Powered Suggestions:** Receive intelligent, automated suggestions from our AI to address identified vulnerabilities.</li>
                    <li>**Real-Time Collaboration:** A built-in chatbox allows your team to communicate and share insights instantly.</li>
                    <li>**Security Risk Analysis:** Get a clear, visual breakdown of your application's security risk level with charts and explanations.</li>
                </ul>
            </section>

            <!-- Credits Section -->
            <section id="credits-section" class="content-section bg-gray-800 p-8 rounded-2xl shadow-lg w-full max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-100 text-center mb-6">Credits</h2>
                <div class="space-y-4 text-center">
                    <p class="text-gray-300 text-lg">
                        This project was developed by a team of dedicated students as part of their academic work, focusing on building a practical and impactful web security platform.
                    </p>
                    <h3 class="text-xl font-bold text-blue-400">The Development Team</h3>
                    <ul class="text-gray-300 text-md space-y-2">
                        <li>**Jacob Sam:** Lead Developer - Responsible for backend logic and API integration.</li>
                        <li>**Joel Heinz:** Frontend Specialist - Focused on the user interface and interactive elements.</li>
                        <li>**Mithil Kumar:** AI Integration Engineer - Worked on connecting the dashboard to the Generative AI model.</li>
                        <li>**Rahul Rajendran:** UI/UX Designer - Shaped the overall look and feel, ensuring a clean and intuitive design.</li>
                        <li>**Madan:** Database Architect - Managed data storage solutions for test case history and project information.</li>
                    </ul>
                    <p class="text-gray-300 text-md pt-4">
                        Special thanks to the open-source community for the tools that made this project possible:
                        <br>Flask, Flask-SocketIO, Tailwind CSS, and Google's Generative AI.
                    </p>
                </div>
            </section>
            
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section bg-gray-800 p-8 rounded-2xl shadow-lg w-full mx-auto">
                <h2 class="text-3xl font-bold text-gray-100 text-center mb-6">Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">

                    <!-- 1. Test Cases & Success Rate -->
                    <div class="bg-gray-700 p-6 rounded-xl shadow-inner flex flex-col">
                        <h3 class="text-xl font-bold text-gray-100 mb-4 flex items-center">
                            <span class="mr-2">üìù</span> Test Case Status
                        </h3>
                        <div class="flex flex-col space-y-4">
                            <div class="p-4 bg-gray-800 rounded-lg shadow">
                                <h4 class="text-lg font-semibold text-gray-200">Test Cases Used: <span id="test-case-count" class="text-blue-400">0</span></h4>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-gray-800 rounded-lg shadow">
                                <div class="flex flex-col items-center">
                                    <span class="text-2xl font-bold text-green-400" id="success-rate">0%</span>
                                    <span class="text-gray-400">Success Rate</span>
                                </div>
                                <div class="w-1/2 h-4 bg-gray-600 rounded-full overflow-hidden">
                                    <div id="success-bar" class="bg-green-400 h-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-gray-800 rounded-lg shadow">
                                <div class="flex flex-col items-center">
                                    <span class="text-2xl font-bold text-red-400" id="failure-rate">0%</span>
                                    <span class="text-gray-400">Failure Rate</span>
                                </div>
                                <div class="w-1/2 h-4 bg-gray-600 rounded-full overflow-hidden">
                                    <div id="failure-bar" class="bg-red-400 h-full transition-all duration-500" style="width: 0%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. AI Suggestions from Analysis -->
                    <div class="bg-gray-700 p-6 rounded-xl shadow-inner flex flex-col h-[500px]">
                        <h3 class="text-xl font-bold text-gray-100 mb-4 flex items-center">
                            <span class="mr-2">ü§ñ</span> AI Suggestions
                        </h3>
                        <div class="flex flex-col items-center space-y-4">
                            <label for="file-input" class="text-md font-semibold text-gray-300">Upload a project document:</label>
                            <input type="file" id="file-input" class="rounded-lg p-2 border-2 border-dashed border-gray-600 bg-gray-800 text-gray-300 w-full focus:outline-none focus:border-blue-500 transition-colors duration-200 cursor-pointer">
                            <button id="analyze-button" class="px-8 py-3 bg-blue-600 text-white font-bold rounded-full shadow-md transition-all duration-200 transform focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                Analyze Document
                            </button>
                        </div>
                        <div class="mt-4 flex-1 overflow-y-auto">
                            <h4 class="text-lg font-bold text-gray-200 mb-2">Analysis Report:</h4>
                            <div id="analysis-output" class="bg-gray-800 text-green-300 p-4 rounded-xl shadow-inner min-h-[150px] text-sm whitespace-pre-wrap">
                                Upload a document and click "Analyze" to begin a security review.
                            </div>
                        </div>
                    </div>

                    <!-- 3. AI Chatbox -->
                    <div class="bg-gray-700 p-6 rounded-xl shadow-inner flex flex-col h-[500px]">
                        <h3 class="text-xl font-bold text-gray-100 mb-4 flex items-center">
                            <span class="mr-2">üí¨</span> AI Chatbot
                        </h3>
                        <div id="chat-box" class="flex-1 overflow-y-auto p-4 border rounded-lg border-gray-600 bg-gray-800 mb-4 space-y-3">
                            <p class="text-gray-300"><strong>WEBSURE Bot:</strong> Hi there! How can I help you today?</p>
                        </div>
                        <div class="flex space-x-2">
                            <input type="text" id="chat-input" placeholder="Ask the bot a question..." class="flex-1 px-4 py-3 rounded-lg border-2 border-gray-600 bg-gray-800 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <button id="chat-send-button" class="bg-blue-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">Send</button>
                        </div>
                    </div>

                    <!-- 4. Statistical Review & Risk Level -->
                    <div class="bg-gray-700 p-6 rounded-xl shadow-inner flex flex-col">
                        <h3 class="text-xl font-bold text-gray-100 mb-4 flex items-center">
                            <span class="mr-2">üõ°Ô∏è</span> Security Risk Analysis
                        </h3>
                        <div class="flex flex-col items-center justify-center">
                            <canvas id="risk-chart" class="w-full max-w-xs h-auto"></canvas>
                            <div class="mt-4 text-center">
                                <span id="risk-level" class="text-4xl font-bold text-red-400"></span>
                                <p class="text-gray-300 text-md" id="risk-explanation"></p>
                            </div>
                        </div>
                    </div>

                </div>
            </section>
        </main>

        <script>
            // --- Navigation Logic ---
            function showSection(sectionId) {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(sectionId + '-section').classList.add('active');
            }

            // --- Chatbot Logic ---
            const chatBox = document.getElementById('chat-box');
            const chatInput = document.getElementById('chat-input');
            const chatSendButton = document.getElementById('chat-send-button');
            
            function displayMessage(sender, message) {
                const messageElement = document.createElement('p');
                messageElement.innerHTML = `<span class="font-semibold text-gray-300">${sender}:</span> <span class="text-gray-400">${message}</span>`;
                chatBox.appendChild(messageElement);
                chatBox.scrollTop = chatBox.scrollHeight;
            }

            async function sendMessage() {
                const message = chatInput.value.trim();
                if (message === '') return;

                displayMessage('You', message);
                chatInput.value = '';

                try {
                    const response = await fetch('/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ message: message }),
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const botReply = await response.text();
                    displayMessage('WEBSURE Bot', botReply);
                } catch (error) {
                    displayMessage('WEBSURE Bot', 'Sorry, I am unable to connect right now.');
                    console.error('Chat API Error:', error);
                }
            }
            
            chatSendButton.addEventListener('click', sendMessage);
            chatInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    sendMessage();
                }
            });

            // --- Test Case Analysis Logic ---
            const fileInput = document.getElementById('file-input');
            const analyzeButton = document.getElementById('analyze-button');
            const analysisOutput = document.getElementById('analysis-output');
            
            // Counters for test case status
            let totalTestCases = 0;
            let successfulTestCases = 0;

            fileInput.addEventListener('change', () => {
                if (fileInput.files.length > 0) {
                    analyzeButton.disabled = false;
                    analyzeButton.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    analyzeButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                    analysisOutput.textContent = "File selected. Ready to analyze...";
                } else {
                    analyzeButton.disabled = true;
                    analyzeButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    analyzeButton.classList.add('bg-gray-400', 'cursor-not-allowed');
                    analysisOutput.textContent = "Upload a document and click 'Analyze' to begin a security review.";
                }
            });

            async function analyzeFile() {
                const file = fileInput.files[0];
                if (!file) {
                    analysisOutput.textContent = "Error: Please select a file first.";
                    return;
                }

                analysisOutput.textContent = "Analyzing document... Please wait.";
                analyzeButton.disabled = true;

                try {
                    const formData = new FormData();
                    formData.append('file', file);
                    
                    const response = await fetch('/analyze', {
                        method: 'POST',
                        body: formData,
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();

                    if (result.error) {
                        analysisOutput.textContent = `Error: ${result.error}`;
                        return;
                    }

                    // Update test case counters and display them
                    totalTestCases = result.test_cases.length;
                    successfulTestCases = result.test_cases.filter(tc => tc.status === 'Checked').length;
                    updateTestStats();

                    // Format and display the AI Suggestions in their own box
                    let outputText = "--- Security Analysis Report ---\n\n";
                    if (result.test_cases && result.test_cases.length > 0) {
                        result.test_cases.forEach((tc, index) => {
                            outputText += `Test Case ${index + 1}: ${tc.test_case}\n`;
                            outputText += `Status: ${tc.status}\n`;
                            outputText += `Explanation: ${tc.explanation}\n\n`;
                        });
                    } else {
                        outputText += "No specific vulnerabilities or test cases were identified in this document.";
                    }

                    analysisOutput.textContent = outputText;

                } catch (error) {
                    analysisOutput.textContent = `Error during analysis: ${error.message}`;
                    console.error('Analysis API Error:', error);
                } finally {
                    analyzeButton.disabled = false;
                }
            }

            analyzeButton.addEventListener('click', analyzeFile);

            // Function to update the test case counters
            function updateTestStats() {
                const total = totalTestCases;
                const success = successfulTestCases;
                const failure = total - success;

                const successRate = total > 0 ? (success / total) * 100 : 0;
                const failureRate = total > 0 ? (failure / total) * 100 : 0;

                document.getElementById('test-case-count').textContent = total;
                document.getElementById('success-rate').textContent = `${successRate.toFixed(0)}%`;
                document.getElementById('failure-rate').textContent = `${failureRate.toFixed(0)}%`;
                document.getElementById('success-bar').style.width = `${successRate}%`;
                document.getElementById('failure-bar').style.width = `${failureRate}%`;
            }


            // --- Statistical Review & Risk Level Logic (Mock Data) ---
            function drawRiskChart() {
                const canvas = document.getElementById('risk-chart');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                let size = Math.min(canvas.width, canvas.height);
                if (window.innerWidth < 640) {
                    size = 200;
                } else {
                    size = 250;
                }
                canvas.width = size;
                canvas.height = size;
                
                // Mock data for the pie chart
                const highRisk = 30; // 30%
                const mediumRisk = 40; // 40%
                const lowRisk = 30; // 30%
                const total = highRisk + mediumRisk + lowRisk;

                const pieData = [
                    { value: highRisk, color: '#f87171' }, // Red
                    { value: mediumRisk, color: '#fbbf24' }, // Amber
                    { value: lowRisk, color: '#4ade80' }    // Green
                ];

                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = Math.min(centerX, centerY) - 10;
                let currentAngle = -Math.PI / 2; // Start from the top

                pieData.forEach(slice => {
                    const sliceAngle = (slice.value / total) * 2 * Math.PI;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = slice.color;
                    ctx.fill();
                    currentAngle += sliceAngle;
                });
                
                // Draw a central circle to create a donut chart effect
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * 0.6, 0, 2 * Math.PI);
                ctx.fillStyle = '#1f2937'; // bg-gray-800
                ctx.fill();
                ctx.closePath();
                
                // Display the overall risk level and explanation
                const riskLevel = document.getElementById('risk-level');
                const riskExplanation = document.getElementById('risk-explanation');
                riskLevel.textContent = "MEDIUM";
                riskLevel.classList.add('text-amber-400');
                riskExplanation.textContent = "The system has a moderate level of security risk based on recent scans.";
            }
            
            // Initial drawing of the chart when the page loads
            window.onload = function() {
                drawRiskChart();
                // Re-draw on window resize to make it responsive
                window.addEventListener('resize', drawRiskChart);
            };
        </script>
    </body>
    </html>
